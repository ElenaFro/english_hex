import{_ as M,c as i,o as n,b as l,t as p,j as T,y as w,e as a,l as _,B as x,K as U,h as f,f as g,F as V,s as z,n as B}from"./index-DGq2-exO.js";import{_ as A}from"./girl_head-D3IPlkvH.js";import{C as D}from"./CongratulationPopup-9vJfjTsE.js";import{u as K}from"./games-DBjNGE6i.js";import{L as O}from"./Loader-cuZxEm2A.js";const H={class:"page-container d-pa-30"},J={class:"page-container__header"},Q={class:"page-container__header_game"},X={class:"page-container__subtitle_game"},Y={class:"page-container__message"},Z={__name:"StartGamePopup",props:{title:{type:String,default:""},subtitle:{type:String,default:""},message:{type:String,default:""},routerPath:{type:String,default:""}},emits:["start"],setup(v,{emit:c}){const r=c;T();const d=()=>{r("start")};return(u,o)=>(n(),i("section",H,[l("section",J,[l("p",Q,p(v.title),1),l("p",X,p(v.subtitle),1),l("p",Y,p(v.message),1),l("button",{class:"action-button",onClick:d},"Начать")]),o[0]||(o[0]=l("section",{class:"image-section"},[l("div",{class:"image-container"},[l("img",{src:A,alt:"girl",class:"girl"})])],-1))]))}},ee=M(Z,[["__scopeId","data-v-a69f1847"]]),te={key:1,class:"game_section"},se={key:0,class:"timer-area"},ae={key:0,class:"error-count"},ne={class:"card-grid"},oe=["onClick"],le=["src"],ie={key:1},re={__name:"ConstellationGame",setup(v){const c=T(),r=w(),d=a(0),u=a(0),o=a([]),h=a([]),C=a([]),y=a(!1),m=a([]),k=a([]),W=a(""),P=a(0),b=a(0);let S;const $=a([]),q=e=>{for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e},E=_(()=>e=>m.value.includes(e.id)),F=_(()=>y.value?"pageNoBg":""),G=_(()=>{const e=b.value*8;return k.value.slice(e,e+8)}),L=_(()=>G.value.map(t=>t.pairId).filter((t,s,I)=>I.indexOf(t)===s).every(t=>h.value.includes(t))),N=e=>{o.value.length<2&&!h.value.includes(e.pairId)&&e.visible&&(o.value.push(e),o.value.length===2&&R())},R=()=>{const[e,t]=o.value;e.isEnglish!==t.isEnglish&&e.english===t.english?(h.value.push(e.id),m.value.push(e.id,t.id),setTimeout(()=>{e.visible=t.visible=!1,m.value=m.value.filter(s=>s!==e.id&&s!==t.id),o.value=[],L.value&&((b.value+1)*8<k.value.length?b.value++:c.push({name:"gameResult",query:{wrong:P.value,from:"constellationGame"}}))},1e3)):(C.value=[...o.value],u.value++,P.value++,d.value++,setTimeout(()=>{C.value=[],o.value=[],u.value=0},1e3))},j=()=>{c.push({name:"planetPage"})};return x(async()=>{loading.value=!0,$.value=await K().getWordForConstellatonGame(r.query.id),k.value=q($.value.flatMap(e=>[{pairId:e.id,displayWord:e.translation_word,isTranslation:!1,visible:!0},{pairId:e.id,displayWord:e.word,isTranslation:!0,visible:!0}])),S=setInterval(()=>{d.value++},1e3)}),U(()=>{clearInterval(S)}),(e,t)=>(n(),i("section",null,[l("div",{class:B(["page-container",F.value])},[e.loading?(n(),f(O,{key:0})):(n(),i("section",te,[y.value?g("",!0):(n(),i("div",se,[l("span",null,p(d.value)+" сек",1),u.value>0?(n(),i("span",ae,"+1")):g("",!0)])),l("div",ne,[(n(!0),i(V,null,z(G.value,(s,I)=>(n(),i("div",{key:I,class:B(["card",{selected:o.value.includes(s),correct:E.value(s),incorrect:C.value.includes(s),hidden:!s.visible}]),onClick:de=>N(s)},[s.isTranslation===!1&&s.visible?(n(),i("img",{key:0,src:s.imageUrl,alt:"Card image",class:"card-image"},null,8,le)):s.visible?(n(),i("span",ie,p(s.displayWord),1)):g("",!0)],10,oe))),128))])]))],2),y.value?(n(),f(D,{key:0,title:"Поздравляю!",message:W.value,onConfirm:j},null,8,["message"])):g("",!0)]))}},ue=M(re,[["__scopeId","data-v-94f408aa"]]),ce="Найдите соответствующее определение для каждого термина. Если вы допустите ошибку, мы добавим к вашему результату дополнительное время.",fe={__name:"ConstellationPage",setup(v){const c=w(),r=a(!0);return x(()=>{c.query.startGame==="true"&&(r.value=!1)}),(d,u)=>r.value?(n(),f(ee,{key:0,title:"Созвездие слов",subtitle:"Готовы?",message:ce,onStart:u[0]||(u[0]=o=>r.value=!r.value)})):(n(),f(ue,{key:1}))}};export{fe as default};
