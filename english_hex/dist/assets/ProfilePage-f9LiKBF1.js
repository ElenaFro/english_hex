import{_ as $,e as p,B as N,i as C,l as M,c as n,b as s,a as O,f as u,w as c,v as _,n as b,t as g,d as V,C as U,o as r,D as E}from"./index-Bnwhgc4X.js";import{B as D}from"./male-jd403OeD.js";import{G}from"./female-DqPS29Md.js";import{d as Z}from"./defaultPopup-DmFdr8K0.js";const k="data:image/svg+xml,%3csvg%20width='18'%20height='20'%20viewBox='0%200%2018%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M17.3114%203.89279L14.1917%200.292786C14.0292%200.105315%2013.8088%200%2013.579%200C13.3492%200%2013.1289%200.105315%2012.9664%200.292786L2.04747%2012.8928C1.9522%2013.0024%201.88065%2013.1363%201.83862%2013.2838L0.278779%2018.6838C0.235412%2018.834%200.22359%2018.994%200.244285%2019.1506C0.26498%2019.3071%200.317602%2019.4558%200.397817%2019.5843C0.478033%2019.7128%200.583548%2019.8175%200.705678%2019.8897C0.827807%2019.9619%200.963058%2019.9997%201.1003%2019.9998C1.19334%2019.9996%201.28577%2019.9824%201.37414%2019.9488L6.05366%2018.1488C6.18118%2018.0998%206.29694%2018.0169%206.39163%2017.9068L17.3105%205.30679C17.4731%205.11939%2017.5645%204.86516%2017.5647%204.59999C17.5648%204.33483%2017.4737%204.08045%2017.3114%203.89279ZM5.31187%2016.3258L2.47036%2017.4188L3.41753%2014.1398L13.579%202.41379L15.4734%204.59979L5.31187%2016.3258Z'%20fill='white'/%3e%3c/svg%3e";function z(w,a){const v={},l=new Set([...Object.keys(w||{}),...Object.keys(a||{})]);for(const i of l){const d=w[i],m=a[i];d!==m&&(v[i]=m)}return v}const A={class:"page-container"},F={class:"avatar-section"},J=["src"],R={class:"profile-card"},T={class:"form-group"},j={class:"input-with-icon"},K={key:0,src:k},q={key:0,class:"error-message"},H={class:"form-group"},Q={class:"gender-options"},W={class:"gender-label"},X={class:"gender-label"},Y={key:0,class:"error-message"},ee={class:"form-group"},se={class:"input-with-icon"},ae={key:0,src:k},le={key:0,class:"error-message"},te={class:"form-group"},oe={class:"input-with-icon"},ne={key:0,src:k},re={key:0,class:"error-message"},ie={class:"button-section"},ue=["disabled"],de={__name:"ProfilePage",setup(w){const a=p({}),v=p({}),l=p({gender:"",name:"",email:"",password:""});N(async()=>{a.value=C().getCurrentUser(),v.value=JSON.parse(JSON.stringify(a.value))});const i=p(!1),d=p(!1),m=p(!0),L=M(()=>{var o;return((o=a.value)==null?void 0:o.gender)==="male"?D:G}),h=()=>{a.value.gender=a.value.gender==="male"?"female":"male"},x=()=>{f("gender")},y=o=>{document.getElementById(o).focus()},f=o=>{l.value[o]=""},I=()=>{let o=!0;l.value={gender:"",name:"",email:"",password:""},a.value.name.trim()||(l.value.name="Поле заполнено некорректно",o=!1);const e=/^(?=.*[A-Za-z0-9])[^<>{}()[\],;:\\/"* ]{8,30}$/;return a.value.email?(!e.test(a.value.email)||!a.value.email.includes("@"))&&(l.value.email="Поле заполнено некорректно",o=!1):(l.value.email="Поле заполнено некорректно",o=!1),o},B=()=>{I()&&(d.value=!0)},P=()=>{d.value=!1},S=async()=>{i.value=!0;try{const o=z(v.value,a.value);await E.patch("/profile/update",o).then(async()=>{await C().fetchUser(),P()}).catch(e=>{throw e})}catch(o){console.error("Ошибка сохранения:",o)}finally{i.value=!1,a.value=C().getCurrentUser()}};return(o,e)=>(r(),n("div",A,[s("div",F,[s("img",{src:L.value,class:"avatar",alt:"User avatar",onClick:h},null,8,J)]),s("div",R,[s("div",T,[e[12]||(e[12]=s("label",{for:"name"},"Имя",-1)),s("div",j,[c(s("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=t=>a.value.name=t),type:"text",maxlength:"17",placeholder:"Введите ваше имя",class:b(["form-input",{error:l.value.name}]),onInput:e[1]||(e[1]=t=>f("name"))},null,34),[[_,a.value.name]]),s("span",{class:"edit-icon",onClick:e[2]||(e[2]=t=>y("name"))},[m.value?(r(),n("img",K)):u("",!0)])]),l.value.name?(r(),n("span",q,g(l.value.name),1)):u("",!0)]),s("div",H,[e[17]||(e[17]=s("label",null,"Пол",-1)),s("div",Q,[s("label",W,[c(s("input",{type:"radio",name:"gender",value:"male","onUpdate:modelValue":e[3]||(e[3]=t=>a.value.gender=t),onChange:x},null,544),[[U,a.value.gender]]),e[13]||(e[13]=s("span",{class:"custom-radio"},null,-1)),e[14]||(e[14]=V(" Мужской "))]),s("label",X,[c(s("input",{type:"radio",name:"gender",value:"female","onUpdate:modelValue":e[4]||(e[4]=t=>a.value.gender=t),onChange:x},null,544),[[U,a.value.gender]]),e[15]||(e[15]=s("span",{class:"custom-radio"},null,-1)),e[16]||(e[16]=V(" Женский "))])]),l.value.gender?(r(),n("span",Y,g(l.value.gender),1)):u("",!0)]),s("div",ee,[e[18]||(e[18]=s("label",{for:"email"},"Email",-1)),s("div",se,[c(s("input",{id:"email","onUpdate:modelValue":e[5]||(e[5]=t=>a.value.email=t),type:"email",maxlength:"30",placeholder:"Ваш email",class:b(["form-input",{error:l.value.email}]),onInput:e[6]||(e[6]=t=>f("email"))},null,34),[[_,a.value.email]]),s("span",{class:"edit-icon",onClick:e[7]||(e[7]=t=>y("email"))},[m.value?(r(),n("img",ae)):u("",!0)])]),l.value.email?(r(),n("span",le,g(l.value.email),1)):u("",!0)]),s("div",te,[e[19]||(e[19]=s("label",{for:"password"},"Пароль",-1)),s("div",oe,[c(s("input",{id:"password","onUpdate:modelValue":e[8]||(e[8]=t=>a.value.password=t),type:"password",maxlength:"30",placeholder:"Ваш пароль",class:b(["form-input",{error:l.value.password}]),onInput:e[9]||(e[9]=t=>f("password"))},null,34),[[_,a.value.password]]),s("span",{class:"edit-icon",onClick:e[10]||(e[10]=t=>y("password"))},[m.value?(r(),n("img",ne)):u("",!0)])]),l.value.password?(r(),n("span",re,g(l.value.password),1)):u("",!0)])]),s("div",ie,[s("button",{class:"action-button",disabled:i.value,onClick:B}," Сохранить изменения ",8,ue)]),O(Z,{isVisible:d.value,title:"Сохранить изменения?",onConfirm:S,"onUpdate:isVisible":e[11]||(e[11]=t=>d.value=t)},null,8,["isVisible"])]))}},fe=$(de,[["__scopeId","data-v-711bd741"]]);export{fe as default};
